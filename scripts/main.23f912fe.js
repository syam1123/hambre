angular.module("hambreApp",["ui.router","ngMaterial","ngStorage","oc.lazyLoad","ngMessages","720kb.tooltips","angularMoment","ngCookies","google-maps","ngSanitize"]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$localStorageProvider","$httpProvider",function(e,t,o,n,a){e.html5Mode(!0),o.otherwise("/search"),t.state("home",{url:"/",templateUrl:"views/home.tmpl.f153a093.html",controller:"homeCtrl",controllerAs:"home","abstract":!0}).state("home.find",{url:"search",templateUrl:"views/searchResto.tmpl.a62a1fca.html",controller:"restoSearchCtrl",controllerAs:"resto"}).state("home.restaurants",{url:"restaurants",templateUrl:"views/restaurents.tmpl.8ab6d80a.html",controller:"restoListCtrl",controllerAs:"list",resolve:{categoriesObj:["commonApiService",function(e){return e.getCategory().then(function(e){return e.data})}],collectionObj:["commonApiService","$localStorage",function(e,t){return e.getCollections(t.locationData,20).then(function(e){return e.data})}]}}).state("home.restaurantDetail",{url:"restaurants/:id",templateUrl:"views/restaurentDetail.tmpl.dfff6171.html",controller:"restoDetailCtrl",controllerAs:"detail",resolve:{RestaruantDetail:["restaurantApiService","$stateParams",function(e,t){return e.getRestoDetail(t.id).then(function(e){return e.data})}],ReviewObj:["restaurantApiService","$stateParams",function(e,t){return e.getReviews(t.id).then(function(e){return e.data})}]}}),n.setKeyPrefix("hambre-")}]).run(["amMoment","$state","$location","$rootScope","$localStorage","$cookies","HAMBREENV",function(e,t,o,n,a,r,i){n.baseUrl=i.BASE_URL,n.$apply(),n.$on("$locationChangeSuccess",function(){n.actualLocation=o.path()}),r.get("userkey")||r.put("userkey",i.USER_KEY)}]).config(["$httpProvider","HAMBREENV",function(e,t){e.defaults.headers.post.Accept="application/json, text/javascript",e.defaults.headers.post["Content-Type"]="application/json; charset=utf-8",e.defaults.headers.common.Accept="application/json, text/javascript",e.defaults.headers.common["Content-Type"]="application/json; charset=utf-8",e.defaults.headers.common["user-key"]=t.USER_KEY}]),function(){angular.module("hambreApp").controller("homeCtrl",["$scope","commonApiService","$state","$timeout","$mdToast",function(e,t,o,o,n,a){var r=this;r.init=function(){},r.init()}])}(),function(){"use strict";function e(e,t,o,n,a,r,i,s,l){function c(e){var t,o=e?d().filter(g(e)):d();return h.simulateQuery?(t=$q.defer(),s(function(){t.resolve(o)},1e3*Math.random(),!1),t.promise):o}function u(e){t.getAllLocations(e).then(function(e){h.locationSuggestions=e.data.location_suggestions})}function p(e){}function d(){return h.locationSuggestions}function g(e){var t=angular.lowercase(e);return function(e){return 0===e.value.indexOf(t)}}function m(e){h.searchBtnActive=!0,r.locationData=e;var t={lat:e.latitude,lon:e.longitude};h.storeOffset?h.storeOffset+=99:h.storeOffset=0;for(var o=h.storeOffset,i=20,s=0;s<5;s++)o=h.storeOffset+20*s,s>=4&&(i=19),n.searchForRestos(t,o,i).then(function(e){19==i&&a.go("home.restaurants")})}var h=this;h.locationSuggestions=[],h.querySearch=c,h.selectedItemChange=p,h.searchTextChange=u,h.searchRestos=m,self.simulateQuery=!1,self.isDisabled=!1,self.init=function(){r.nearbyRestos=[],t.getAllLocations("new",10).then(function(e){h.locationSuggestions=e.data.location_suggestions,h.allLocation=d()})},self.init(),h.getlocation=function(){h.buttonState=!0,s(function(){e.locationGot||l.show(l.simple().textContent("Hold on! sometimes it will take some time").position("top").hideDelay(3e3))},5e3),s(function(){e.locationGot||(l.show(l.simple().textContent("Sorry! can't get your location").position("top").hideDelay(5e3)),h.buttonState=!1)},1e4),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.$apply(function(){e.position=t,o.getGeoCode(e.position.coords).then(function(t){h.selectedItem=t.data.location,h.buttonState=!1,e.locationGot=!0})})},function(){l.show(l.simple().textContent("Sorry! Your navigator is not responding").position("top").hideDelay(5e3)),h.buttonState=!1,e.locationGot=!0},{enableHighAccuracy:!0})}}angular.module("hambreApp").controller("restoSearchCtrl",e),e.$inject=["$scope","locationApiService","commonApiService","restaurantApiService","$state","$localStorage","$document","$timeout","$mdToast"]}(),function(){"use strict";function e(e,t,o,n,a,r,i,s){function l(){return g.restaurants}function c(e){a.go("home.restaurantDetail",{id:e})}function u(e){g.restaurantsToShow=[],g.showLoader=!0;var t=!0;g.storeOffset?g.storeOffset+=99:g.storeOffset=0;for(var o=g.storeOffset,a=20,r=0;r<5;r++)o=g.storeOffset+20*r,r>=4&&(a=19),n.searchForRestos(e,o,a,t).then(function(e){g.restaurantsToShow.push.apply(g.restaurantsToShow,e.data.restaurants),g.showLoader=!1})}function p(e){g.selectedCategories.indexOf(e)<0?g.selectedCategories.push(e):g.selectedCategories.splice(g.selectedCategories.indexOf(e),1);var t={category:g.selectedCategories.join(","),lat:r.locationData.latitude,lon:r.locationData.longitude};u(t)}function d(){var e="";g.choosedCategories.length>0&&(e=g.choosedCategories.join(","));var t={category:g.choosedCategories.join(","),lat:r.locationData.latitude,lon:r.locationData.longitude};u(t)}var g=this;g.getRestaurantsToShow=l,g.getMoreDetails=c,g.showSpecificCategory=p,g.searchCategory=d,g.init=function(){g.restaurants=r.nearbyRestos,g.locatiosData=r.locationData,g.restaurantsToShow=g.getRestaurantsToShow(),g.noImage="http://balifoodandfun.com/wp-content/themes/balifoodandfun/images/no-image-available.png",g.categoriesObj=i.categories,g.trendingCollections=s.collections,g.selectedCategories=[]},g.init()}angular.module("hambreApp").controller("restoListCtrl",e),e.$inject=["$scope","locationApiService","commonApiService","restaurantApiService","$state","$localStorage","categoriesObj","collectionObj"]}(),function(){"use strict";function e(e,t,o,n,a,r,i,s,l){var c=this;c.restoData=i,c.noImage="http://balifoodandfun.com/wp-content/themes/balifoodandfun/images/no-image-available.png",c.init=function(){return i?(c.userLocation=r.locationData,c.storeLocation=c.restoData.location,c.reviews=l.user_reviews,void window.scrollTo(0,0)):void a.go("home.restaurants")},c.init(),c.map={control:{},center:{latitude:c.userLocation.latitude,longitude:c.userLocation.longitude},zoom:14},c.marker={center:{latitude:c.userLocation.latitude,longitude:c.userLocation.longitude}};var u=new google.maps.DirectionsRenderer,p=new google.maps.DirectionsService;new google.maps.Geocoder;c.directions={origin:c.userLocation.title,destination:c.storeLocation.address},c.getDirections=function(){var e={origin:new google.maps.LatLng(c.userLocation.latitude,c.userLocation.longitude),destination:new google.maps.LatLng(c.storeLocation.latitude,c.storeLocation.longitude),travelMode:google.maps.DirectionsTravelMode.DRIVING};p.route(e,function(e,t){t===google.maps.DirectionsStatus.OK?(u.setDirections(e),u.setMap(c.map.control.getGMap()),u.setPanel(document.getElementById("directionsList")),c.directions.showList=!0):s.show(s.simple().textContent("Sorry! direction is unavailable").position("top").hideDelay(5e3))})},c.getDirections()}angular.module("hambreApp").controller("restoDetailCtrl",e),e.$inject=["$scope","locationApiService","commonApiService","restaurantApiService","$state","$localStorage","RestaruantDetail","$mdToast","ReviewObj"]}(),function(){return angular.module("hambreApp").constant("HAMBREENV",{API_ENDPOINT:"https://developers.zomato.com/",USER_KEY:"076ab577bbb0b2476c8387f8dde1b466",BASE_URL:"https://syam1123.github.io/hambre/"})}(),function(){"use strict";function e(e,t,o,n,a){function r(o){var n=t.defer();return e({url:i+s.locations,method:"GET",params:{query:o,count:10}}).then(function(e){n.resolve(e)},function(e){n.resolve(e),a.show(a.simple().textContent("Sorry! Our server is down, please try again later").position("top").hideDelay(5e3))}),n.promise}var i=n.API_ENDPOINT,s={locations:"api/v2.1/locations",locationDetail:"api/v2.1/location_details"};return{getAllLocations:r}}angular.module("hambreApp").factory("locationApiService",e),e.$inject=["$http","$q","$window","HAMBREENV","$mdToast"]}(),function(){"use strict";function e(e,t,o,n,a,r){function i(o,n,i,s){var l=t.defer();return e({url:c+u.search,method:"GET",params:{lat:o.lat,lon:o.lon,cuisines:o.cuisines,establishment_type:o.establishment_type,collection_id:o.collection_id,category:o.category,start:n,count:i}}).then(function(e){l.resolve(e),s||a.nearbyRestos.push.apply(a.nearbyRestos,e.data.restaurants)},function(e){l.resolve(e),r.show(r.simple().textContent("Sorry! Our server is down, please try again later").position("top").hideDelay(5e3))}),l.promise}function s(o,n,i){var s=n?n:0,l=i?i:20,p=t.defer();return e({url:c+u.reviews,method:"GET",params:{res_id:o,start:s,count:l}}).then(function(e){p.resolve(e),a.nearbyRestos.push.apply(a.nearbyRestos,e.data.restaurants)},function(e){p.resolve(e),r.show(r.simple().textContent("Sorry! Our server is down, please try again later").position("top").hideDelay(5e3))}),p.promise}function l(o){var n=t.defer();return e({url:c+u.restaurant,method:"GET",params:{res_id:o}}).then(function(e){n.resolve(e),a.nearbyRestos.push.apply(a.nearbyRestos,e.data.restaurants)},function(e){n.resolve(e),r.show(r.simple().textContent("Sorry! Our server is down, please try again later").position("top").hideDelay(5e3))}),n.promise}var c=n.API_ENDPOINT,u={search:"api/v2.1/search",reviews:"api/v2.1/reviews",restaurant:"api/v2.1/restaurant",dailyMenu:"api/v2.1/dailymenu"};return{searchForRestos:i,getRestoDetail:l,getReviews:s}}angular.module("hambreApp").factory("restaurantApiService",e),e.$inject=["$http","$q","$window","HAMBREENV","$localStorage","$mdToast"]}(),function(){"use strict";function e(e,t,o,n,a,r){function i(){var o=t.defer();return e({url:u+p.category,method:"GET"}).then(function(e){o.resolve(e)},function(e){o.resolve(e),r.show(r.simple().textContent("Sorry! Unable to show categories").position("top").hideDelay(5e3))}),o.promise}function s(o,n){var a=t.defer();return e({url:u+p.collections,method:"GET",params:{lat:o.latitude,lon:o.longitude,count:n}}).then(function(e){a.resolve(e)},function(e){a.resolve(e),r.show(r.simple().textContent("Sorry! Unable to get the collections near your place").position("top").hideDelay(5e3))}),a.promise}function l(o){var n=t.defer();return e({url:u+p.geoCode,method:"GET",params:{lat:o.latitude,lon:o.longitude}}).then(function(e){n.resolve(e)},function(e){n.resolve(e),r.show(r.simple().textContent("Sorry! something went wrong. please try again").position("top").hideDelay(5e3))}),n.promise}function c(o){var n=t.defer();return e({url:u+p.geoCode,method:"GET",params:{lat:o.latitude,lon:o.longitude}}).then(function(e){n.resolve(e)},function(e){n.resolve(e),r.show(r.simple().textContent("Sorry! Unable to get the cuisins near your place").position("top").hideDelay(5e3))}),n.promise}var u=n.API_ENDPOINT,p={category:"api/v2.1/categories",citis:"api/v2.1/cities",collections:"api/v2.1/collections",cuisines:"api/v2.1/cuisines",establishments:"api/v2.1/establishments",geoCode:"api/v2.1/geocode"};return{getCategory:i,getGeoCode:l,getCollections:s,getCuisines:c}}angular.module("hambreApp").factory("commonApiService",e),e.$inject=["$http","$q","$window","HAMBREENV","$localStorage","$mdToast"]}();